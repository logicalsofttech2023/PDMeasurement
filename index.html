<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vite + React</title>
    <style>
      /* Fixed size container */
      #my-fitmix-container {
        width: 660px;
        height: 560px;
        display: none; /* hidden initially */
        border: 1px solid #ccc;
        margin-top: 20px;
      }

      #startVtoBtn {
        margin-top: 20px;
        padding: 10px 20px;
        font-size: 16px;
      }
    </style>
  </head>
  <body>
    <!-- <div id="root"></div> -->
    <button id="startVtoBtn" disabled>Start PD Measurement</button>
    <div id="my-fitmix-container"></div>

    <!-- Load VTO script over HTTPS -->
    <script
      src="https://vto-advanced-integration-api.fittingbox.com/index.js"
      type="text/javascript"
    ></script>
    <script>
      const fitmixContainer = document.getElementById("my-fitmix-container");
      const startBtn = document.getElementById("startVtoBtn");
      let fitmixInstance;

      // Function to hide the VTO container after stopping
      function hideModule() {
        fitmixContainer.style.display = "none";
      }

      // Initialize FitMix
      const params = {
        apiKey: "TBVAcXitApiZPVH791yxdHbAc8AKzBwtCnjtv6Xn", // Demo API key
        onStopVto: hideModule,
        mode: "pd", // PD measurement mode
        frameId: "8053672909258", // Demo frame
      };

      // Instantiate the VTO module
      fitmixInstance = FitMix.createWidget(
        "my-fitmix-container",
        params,
        function () {
          console.log("VTO module is ready.");
          startBtn.disabled = false; // enable the start button
        }
      );

      // Start VTO when button is clicked
      startBtn.addEventListener("click", () => {
        fitmixContainer.style.display = "block"; // show container
        fitmixInstance.startVto("live"); // start PD measurement
      });

      // Optional: stop VTO manually (if you have a close button)
      function onCloseAction() {
        fitmixInstance.stopVto();
      }
    </script>
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>
